define("widget/formSubmit/1.0.0/formSubmit",["$"],function(a,b,c){var d=a("$"),e="body";formSubmit=function(a){var b="";if(d('#tsh-ifm,form[target="tsh-ifm"]').remove(),a.param){if(!a.action)throw new Error("form action is undefined");if(a.form=d('<form action="'+a.action+'" method="'+("post"==(a.method+"").toLowerCase()?"post":"get")+'" target="tsh-ifm"></form>'),Array.isArray(a.param))a.param.forEach(function(b){"undefined"==typeof(b.name||b.key)||a.form.append('<input type="hidden" name="'+(b.name||b.key)+'" value="'+b.value+'">')});else for(var c in a.param)a.form.append('<input type="hidden" name="'+c+'" value="'+a.param[c]+'">');a.form.appendTo(e)}else if(a.form){if(a.form=d(a.form),!a.form.length)throw new Error("form is undefined");b=a.form.attr("target"),a.form.attr("target","tsh-ifm")}var f=d('<iframe src="about:blank" '+(a.enctype===!0?'enctype="multipart/form-data"':"")+' id="tsh-ifm" name="tsh-ifm"><iframe>');return f.css({position:"absolute",left:"-1000px",top:"-1000px",width:1,height:1,overflow:"hidden"}),f.appendTo(e).on("load",function(){if("function"==typeof a.callback){var b=f.contents().text().replace(/^\s+|\s+$/gm,"");try{b=d.parseJSON(b)}catch(c){}a.callback.apply(a.form,[f,b])}setTimeout(function(){f.remove(),f=null,a.param&&(a.form.remove(),a.form=null)},30)}),a.form.trigger("submit"),a.param||a.form[b?"attr":"removeAttr"]("target",b),a.form},c.exports=formSubmit});
